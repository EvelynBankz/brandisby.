<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sérac - Track Order</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
:root {
  --bg:#141517;
  --accent:#B66E41;
  --muted:#9aa0a4;
  --surface:#1c1e22;
  --radius:16px;
  --transition:200ms cubic-bezier(.2,.8,.2,1);
}
*{margin:0;padding:0;box-sizing:border-box;}
body{
  font-family:"Montserrat",sans-serif;
  background:linear-gradient(180deg,var(--bg) 0%,#0f1011 100%);
  color:#E7E7E7;
  min-height:100vh;
  overflow-x:hidden;
}

/* HEADER */
header{
  position:fixed;
  top:0;left:0;right:0;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:18px 30px;
  z-index:1000;
  background:transparent;
  transition:background 0.3s ease;
  backdrop-filter:blur(6px);
}
header.scrolled{
  background:rgba(0,0,0,0.85);
}
.header-left{
  display:flex;
  align-items:center;
  gap:12px;
}
.header-left img{
  height:50px;
}
.header-left h1{
  font-family:"Playfair Display",serif;
  color:#fff;
  font-size:24px;
}
.nav-links{
  display:flex;
  gap:22px;
  align-items:center;
}
.nav-links a{
  color:var(--muted);
  text-decoration:none;
  font-weight:500;
  transition:color var(--transition);
}
.nav-links a:hover{
  color:var(--accent);
}
.cart-count{
  background:var(--accent);
  color:#111;
  border-radius:999px;
  font-size:12px;
  padding:4px 7px;
  margin-left:4px;
}
.hamburger{
  display:none;
  flex-direction:column;
  gap:5px;
  cursor:pointer;
}
.hamburger span{
  width:24px;
  height:3px;
  background:#fff;
  border-radius:2px;
}
@media(max-width:860px){
  .nav-links{
    position:fixed;
    top:0;right:-100%;
    height:100vh;
    width:70%;
    background:#111;
    flex-direction:column;
    justify-content:center;
    transition:right 0.3s ease;
  }
  .nav-links.active{right:0;}
  .hamburger{display:flex;}
}

/* MAIN SECTION */
main{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:140px 20px 80px;
}
.track-box{
  background:var(--surface);
  border-radius:var(--radius);
  padding:60px 50px;
  max-width:900px;
  width:100%;
  box-shadow:0 12px 40px rgba(0,0,0,0.6);
}
.track-box h1{
  font-family:"Playfair Display",serif;
  font-size:30px;
  color:#fff;
  margin-bottom:14px;
}
.track-box p{
  color:var(--muted);
  margin-bottom:32px;
}
form{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:16px;
}
input{
  background:#191A1B;
  border:1px solid rgba(255,255,255,0.06);
  border-radius:10px;
  padding:12px 14px;
  color:#fff;
  font-size:15px;
  width:100%;
  max-width:400px;
  transition:border-color var(--transition);
}
input:focus{border-color:var(--accent);outline:none;}
button{
  background:linear-gradient(90deg,var(--accent),#a85a35);
  color:#111;
  border:none;
  border-radius:12px;
  padding:14px 36px;
  font-weight:600;
  cursor:pointer;
  transition:transform var(--transition),box-shadow var(--transition);
}
button:hover{
  transform:translateY(-3px);
  box-shadow:0 18px 48px rgba(182,110,65,0.18);
}

/* ORDER STATUS */
.order-status{
  display:none;
  margin-top:40px;
  background:rgba(255,255,255,0.02);
  border:1px solid rgba(255,255,255,0.05);
  border-radius:20px;
  padding:40px;
  text-align:left;
  max-width:820px;
  margin:auto;
  box-shadow:0 10px 30px rgba(0,0,0,0.3);
}
.order-status h3{
  font-family:"Playfair Display",serif;
  text-align:center;
  margin-bottom:20px;
  color:#fff;
}
.order-details{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:18px 24px;
  list-style:none;
  padding:0;
}
.order-details li{
  background:rgba(255,255,255,0.03);
  padding:14px 18px;
  border-radius:10px;
  color:#ddd;
  transition:transform 0.2s ease, background 0.3s ease;
}
.order-details li:hover{
  background:rgba(255,255,255,0.06);
  transform:translateY(-3px);
}
.order-details strong{
  color:var(--accent);
  display:block;
  font-weight:600;
  margin-bottom:4px;
}

/* FOOTER */
footer{
  text-align:center;
  padding:30px 10px;
  color:var(--muted);
  margin-top:60px;
}

/* SPINNER */
#serac-overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.7);
  backdrop-filter:blur(6px);
  z-index:9999;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  opacity:0;
  pointer-events:none;
  transition:opacity 0.3s ease;
}
#serac-overlay.active{opacity:1;pointer-events:all;}
.spinner{
  width:60px;height:60px;
  border:6px solid rgba(255,255,255,0.15);
  border-top:6px solid var(--accent);
  border-radius:50%;
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg);}}
.spinner-text{
  color:var(--accent);
  margin-top:16px;
  font-weight:500;
  letter-spacing:0.5px;
  font-size:15px;
}
</style>
</head>

<body>

<header id="mainHeader">
  <div class="header-left">
    <img src="Serac/Assets/logo.png" alt="Sérac Logo">
    <h1>Sérac</h1>
  </div>
  <nav class="nav-links" id="navMenu">
    <a href="index.html">Home</a>
    <a href="shop.html">Shop</a>
    <a href="about.html">About</a>
    <a href="cart.html">Cart <span class="cart-count" id="cartCount">0</span></a>
    <a href="customization.html">Customize</a>
    <a href="contact.html">Contact</a>
  </nav>
  <div class="hamburger" id="hamburger">
    <span></span><span></span><span></span>
  </div>
</header>

<main>
  <div class="track-box">
    <h1>Track Your Order</h1>
    <p>Enter your Order Reference Number below to check your order status.</p>

    <form id="trackOrderForm">
      <input type="text" id="orderRef" placeholder="Enter your order reference" required>
      <button type="submit">Check Status</button>
    </form>

    <div class="order-status" id="orderStatus">
      <h3>Order Details</h3>
      <ul class="order-details" id="orderDetails"></ul>
    </div>
  </div>
</main>

<div id="serac-overlay">
  <div class="spinner"></div>
  <div class="spinner-text">Fetching order...</div>
</div>

<footer>
  © <span id="year"></span> Sérac. All rights reserved.
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

/* FIREBASE CONFIG */
const firebaseConfig = {
  apiKey: "AIzaSyCuiZXHFYl1fVKnGwojavRvbekSBpkipJg",
  authDomain: "brandisby.firebaseapp.com",
  projectId: "brandisby",
  storageBucket: "brandisby.firebasestorage.app",
  messagingSenderId: "87213267039",
  appId: "1:87213267039:web:339e9fd49e3ad31f7423ea"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* ELEMENTS */
const form = document.getElementById('trackOrderForm');
const statusBox = document.getElementById('orderStatus');
const detailsList = document.getElementById('orderDetails');
const overlay = document.getElementById('serac-overlay');

/* SPINNER */
function showSpinner(show){overlay.classList.toggle('active', show);}

/* FETCH ORDER */
form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const ref = document.getElementById('orderRef').value.trim();
  if (!ref) return alert('Please enter an order reference.');
  showSpinner(true);
  detailsList.innerHTML = '';
  statusBox.style.display = 'none';
  try {
    const q = query(collection(db, "orders"), where("trackingRef", "==", ref));
    const snap = await getDocs(q);
    showSpinner(false);
    if (snap.empty) {
      statusBox.style.display = 'block';
      detailsList.innerHTML = '<li><strong>Notice:</strong> No order found for that reference.</li>';
      return;
    }
    const doc = snap.docs[0].data();
    const date = doc.date ? new Date(doc.date).toLocaleString() : '—';
    const amount = doc.total ? `${doc.currency || '₦'}${doc.total.toLocaleString()}` : '—';
    detailsList.innerHTML = `
      <li><strong>Status</strong>${doc.status || 'Processing'}</li>
      <li><strong>Date</strong>${date}</li>
      <li><strong>Email</strong>${doc.email || '—'}</li>
      <li><strong>Amount</strong>${amount}</li>
      <li style="grid-column: span 2"><strong>Items</strong>${(doc.items || []).map(i => `${i.name} (${i.qty})`).join('<br>')}</li>
    `;
    statusBox.style.display = 'block';
  } catch (err) {
    console.error(err);
    showSpinner(false);
    statusBox.style.display = 'block';
    detailsList.innerHTML = '<li><strong>Error:</strong> Unable to fetch order details. Try again later.</li>';
  }
});

/* HEADER SCROLL EFFECT */
const header = document.getElementById('mainHeader');
window.addEventListener('scroll',()=>{window.scrollY>40?header.classList.add('scrolled'):header.classList.remove('scrolled');});

/* HAMBURGER MENU */
const hamburger=document.getElementById('hamburger');
const navMenu=document.getElementById('navMenu');
hamburger.addEventListener('click',()=>{navMenu.classList.toggle('active');});

/* FOOTER YEAR */
document.getElementById('year').textContent = new Date().getFullYear();
</script>
</body>
</html>
