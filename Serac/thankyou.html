<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Thank You - SÃ©rac</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

 <style>
:root{
  --bg-dark: #141517;
  --bg-mid: #2A2B30;
  --gold: #B66E41;
  --muted: #bdbdbd;
  --accent-strong: rgba(182,110,65,0.95);
  --radius: 12px;
  --transition: 0.25s cubic-bezier(.2,.9,.2,1);
}

/* RESET */
* { margin:0; padding:0; box-sizing:border-box; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
body { font-family:"Montserrat", sans-serif; background:var(--bg-dark); color:#e6e6e6; line-height:1.6; }
a { text-decoration:none; color:inherit; transition: color var(--transition); }

/* HEADER */
.site-header {
  background: transparent;
  transition: background 0.3s ease, border-bottom 0.3s ease;
  color:#f5f5f5;
  display:flex; justify-content:space-between; align-items:center;
  padding:16px 28px;
  position:fixed; top:0; left:0; right:0;
  z-index:1000;
  border-bottom:1px solid rgba(255,255,255,0.04);
}
.site-header.scrolled { background:var(--bg-dark); border-bottom:1px solid rgba(255,255,255,0.06); }

.header-left { display:flex; align-items:center; gap:14px; }
.brand-logo { height:56px; width:auto; object-fit:contain; filter: drop-shadow(0 4px 12px rgba(0,0,0,0.6)); }
.brand-title { font-family:"Playfair Display", serif; font-size:22px; font-weight:700; color:var(--gold); letter-spacing:0.6px; }

.header-right { display:flex; gap:22px; align-items:left; }
.header-right a { font-weight:500; color:var(--muted); padding:6px 8px; border-radius:8px; transition: all var(--transition); }
.header-right a:hover { color:#fff; transform:translateY(-2px); text-shadow: 0 4px 18px rgba(182,110,65,0.15); }

.cart-count { background:var(--gold); color:var(--bg-dark); font-size:12px; font-weight:700; border-radius:50%; padding:3px 7px; margin-left:6px; box-shadow:0 4px 10px rgba(182,110,65,0.12); }

/* Hamburger */
.hamburger { display:none; background:none; border:none; cursor:pointer; width:30px; height:24px; position:relative; }
.hamburger span { display:block; width:100%; height:3px; background:#B66E41; border-radius:2px; position:absolute; left:0; transition:0.3s; }
.hamburger span:nth-child(1){ top:0; }
.hamburger span:nth-child(2){ top:10px; }
.hamburger span:nth-child(3){ top:20px; }
.hamburger.open span:nth-child(1){ transform:rotate(45deg); top:10px; background:#B66E41; }
.hamburger.open span:nth-child(2){ opacity:0; }
.hamburger.open span:nth-child(3){ transform:rotate(-45deg); top:10px; background:#B66E41; }

/* HERO */
.hero { position: relative; height: 95vh; display: flex; justify-content: center; align-items: center; text-align: center; margin-top: 0px; overflow: hidden; padding-top:72px; }
.hero::after { content: ""; position: absolute; inset: 0; background: url("asset/bg25.jpg") center/cover no-repeat; transform: scale(1.06); z-index: -1; border-radius: 12px; box-shadow: inset 0 0 0 2000px rgba(20,21,23,0.55); }
.hero-text { position: relative; display: inline-block; margin-bottom:12px; }
.hero-text h1 { font-family:"Playfair Display", serif; font-size: clamp(36px,5vw,64px); margin-bottom:12px; color:#B66E41; }
.hero-text p { font-size: clamp(16px,2vw,22px); max-width:700px; color:#F5F5F3}


/* === UNDERLINE HOVER EFFECT (replicated from About page) === */
.header-right a {
  color: #F5F5F3;
  position: relative;
  padding: 6px 0;
  font-size: 1rem;
  font-weight: 500;
  transition: color 0.3s ease;
}

.header-right a::after {
  content: "";
  position: absolute;
  bottom: -4px;
  left: 0;
  width: 0;
  height: 2px;
  background: var(--gold);
  transition: width 0.3s ease;
}

.header-right a:hover {
  color: var(--gold);
}

.header-right a:hover::after {
  width: 100%;
}


/* Main *    /* Center the box in the viewport */
.thankyou-section {
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 100px 20px;
}

/* Center all content inside the box */
.thankyou-box {
  max-width: 960px;             /* âœ… wider than 760px */
  width: 100%;
  background: #1c1e22;
  padding: 60px;                /* a bit more breathing room */
  border-radius: 16px;
  box-shadow: 0 12px 40px rgba(0,0,0,0.6);
  color: #ddd;
  text-align: center;           /* center everything inside */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}


.thankyou-box h2{font-family:"Playfair Display",serif;color:#B66E41;margin-bottom:12px}
.thankyou-box p{color:#ccc;margin-bottom:10px}

#orderReferenceBox{
  background:#17181b;padding:14px 20px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);
  font-weight:600;font-size:18px;color:#fff;margin:14px 0;cursor:pointer;display:inline-block;
}
#orderReferenceNote{color:#999;font-size:13px;margin-bottom:12px}
.order-details{background:#17181b;padding:20px;border-radius:10px;text-align:center;;border:1px solid rgba(255,255,255,0.04)}
.order-details h3{color:#B66E41;text-align:center;font-family:"Playfair Display",serif;margin-bottom:8px}
.order-details li{color:#eee;padding:10px 0;text-align:left;list-style: none;border-bottom:1px solid rgba(255,255,255,0.02)}

.btn{display:inline-block;padding:12px 26px;border-radius:8px;font-weight:600;cursor:pointer;margin-top:12px}
.btn-primary{background:#B66E41;color:#fff;border:0}
.btn-secondary{background:transparent;color:#B66E41;border:2px solid #B66E41}

footer{padding:28px;text-align:center;color:#777;margin-top:60px}

/* Overlay & spinner */
#serac-overlay{
  position:fixed;inset:0;z-index:9999;display:flex;align-items:center;justify-content:center;
  background:rgba(0,0,0,0.95);backdrop-filter:blur(6px);transition:opacity .45s ease;
}
.gold-spinner{
  width:64px;height:64px;border-radius:50%;
  border:5px solid rgba(182,110,65,0.18);border-top-color:#B66E41;animation:serac-spin 1s linear infinite;
  box-shadow:0 6px 26px rgba(0,0,0,0.6);
}
@keyframes serac-spin{to{transform:rotate(360deg)}}

 /* Chat-style floating support button */
#floatingSupportBtn {
  position: fixed;
  bottom: 25px;
  right: 25px;
  width: 56px;
  height: 56px;
  background: #1a202b; /* SÃ©rac primary color */
  color: #fff;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  font-size: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 6px 20px rgba(182, 110, 65, 1);
  transition: all 0.3s ease;
  z-index: 9999;
}

#floatingSupportBtn:hover {
  background: #20232b; /* Slightly lighter shade on hover */
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(75, 78, 84, 1.0);
}

/* Tooltip */
.support-tooltip {
  position: absolute;
  bottom: 30px;      /* Distance above the button */
  left: 20%;
  transform: translateX(-50%); /* Center horizontally */
  background: #1c1e22;
  color: #fff;
  padding: 6px 12px;
  border-radius: 8px;
  font-size: 14px;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease, transform 0.3s ease;
}


#floatingSupportBtn:hover .support-tooltip {
  opacity: 1;
  transform: translateY(-50%) translateX(0);
}

    
/* ================= FOOTER ================= */
footer {
  text-align:center;
  padding:28px;
  background:#141517;
  color:#aaa;
  margin-top:60px;
}
footer p { font-size:14px; }

    
/* ================= RESPONSIVE ================= */
@media(max-width:900px){
  section.story .container { grid-template-columns:1fr; gap:30px; }
  .contact-flex { flex-direction:column; }
}

@media(max-width:600px){
  .header-right {
    display:none;
    flex-direction:column;
    background:#141517;
    position:absolute;
    top:70px;
    right:0;
    width:220px;
    padding:20px;
    border-radius:0 0 0 12px;
  }
  .header-right.open { display:flex; }
  .hamburger { display:block; }
  .hero { height:50vh; }
  .hero-text h1 { font-size:28px; }
}    
    
</style>

<style>
@media(min-width: 900px) {
  .hero { position: relative; overflow: visible; }

  .hero-peek {
    position: absolute;
    bottom: -20px;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    height: 20px;
    border-radius: 10px / 50%;
    z-index: 2;
    box-shadow: 0 -6px 15px rgba(0,0,0,0.15);
    animation: peekFloat 2s ease-in-out infinite alternate;
  }

  .hero-peek[data-theme="dark"] {
    background: linear-gradient(to top, rgba(182,110,65,0.3), transparent);
  }

  .hero-peek[data-theme="light"] {
    background: linear-gradient(to top, rgba(255,235,200,0.35), transparent);
  }

  @keyframes peekFloat {
    0% { transform: translateX(-50%) translateY(0); opacity: 0.85; }
    100% { transform: translateX(-50%) translateY(-4px); opacity: 1; }
  }
}
</style>

</head>
<body>
  <!-- Loader overlay -->
  <div id="serac-overlay" aria-hidden="true">
    <div class="gold-spinner" role="status" aria-label="Loading"></div>
  </div>

  <header class="site-header" id="siteHeader">
    <div class="header-left">
      <img src="asset/logo.png" alt="SÃ©rac" class="brand-logo" />
      <div class="brand-title">SÃ©rac</div>
    </div>

    <nav class="header-right" id="headerRight">
      <a href="index.html">Home</a>
      <a href="shop.html">Shop</a>
      <a href="about.html">About</a>
      <a href="contact.html">Contact</a>
      <a href="trackorder.html">Track</a>
    </nav>

    <button class="hamburger" id="hamburger" aria-label="Menu" aria-expanded="false">
      <span></span><span></span><span></span>
    </button>
  </header>

  <main>
    <section class="hero">
      <h1>Thank You</h1>
      <p>For Trusting Us</p>
    </section>

    <section class="thankyou-section">
      <div class="thankyou-box">
        <h2>Weâ€™ve received your order ðŸŽ‰</h2>
        <p>Thank you for shopping with <strong>SÃ©rac</strong>. Your order is now being processed.</p>

        <div id="orderReferenceBox">Loading referenceâ€¦</div>
        <div id="orderReferenceNote"></div>

        <div style="margin:14px 0;">
          <button id="sendEmailBtn" class="btn btn-secondary">Send to my email</button>
        </div>

        <div class="order-details" id="orderDetails">
          <p>Loading order detailsâ€¦</p>
        </div>

        <div style="margin-top:18px">
          <a href="shop.html" class="btn btn-primary">Continue Shopping</a>
          <a id="trackOrderBtn" href="trackorder.html" class="btn btn-secondary">Track Order</a>
        </div>
      </div>
    </section>
  </main>
  
    <!-- Floating Chat-Style Support Button -->
  <button id="floatingSupportBtn" aria-label="Contact Support">
    <i class="fas fa-headset"></i>
    <span class="support-tooltip">Support</span>
  </button>
  
  <footer>Â© 2025 SÃ©rac</footer>

  <script type="module">
    // ------------- UI behavior -------------
    const overlay = document.getElementById('serac-overlay');
    const header = document.getElementById('siteHeader');
    const hamburger = document.getElementById('hamburger');
    const headerRight = document.getElementById('headerRight');

    // // Scroll header
    // window.addEventListener('scroll', () => header.classList.toggle('scrolled', window.scrollY > 30));

    // âœ… Fix: Hamburger toggle logic
    if (hamburger && headerRight) {
      hamburger.addEventListener('click', () => {
        hamburger.classList.toggle('open');
        headerRight.classList.toggle('open');
        const expanded = hamburger.classList.contains('open');
        hamburger.setAttribute('aria-expanded', expanded);
      });
    }
        

    // ------------- Firestore imports -------------
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.3.1/firebase-app.js";
    import { getFirestore, doc, getDoc, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.3.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCuiZXHFYl1fVKnGwojavRvbekSBpkipJg",
      authDomain: "brandisby.firebaseapp.com",
      projectId: "brandisby",
      storageBucket: "brandisby.firebasestorage.app",
      messagingSenderId: "87213267039",
      appId: "1:87213267039:web:339e9fd49e3ad31f7423ea"
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // ------------- Helpers -------------
    function safeParseJSON(v){ try{ return JSON.parse(v||'null'); } catch(e){ return null; } }

    function showCopyPopup(text){
      const pop = document.createElement('div');
      pop.textContent = text;
      Object.assign(pop.style, {
        position:'fixed',left:'50%',bottom:'36px',transform:'translateX(-50%)',
        background:'#B66E41',color:'#fff',padding:'10px 16px',borderRadius:'8px',zIndex:10000,opacity:'0',transition:'opacity .25s'
      });
      document.body.appendChild(pop);
      requestAnimationFrame(()=> pop.style.opacity='1');
      setTimeout(()=> { pop.style.opacity='0'; setTimeout(()=>pop.remove(),280); },1800);
    }

    // ------------- Main display logic -------------
    async function displayOrder(){
      const refBox = document.getElementById('orderReferenceBox');
      const note = document.getElementById('orderReferenceNote');
      const details = document.getElementById('orderDetails');
      const trackBtn = document.getElementById('trackOrderBtn');
      const sendEmail = document.getElementById('sendEmailBtn');

      // 1) Prefer local saved order from checkout flow
      let order = safeParseJSON(localStorage.getItem('lastOrder_serac'));

      // 2) Check URL params (orderId, txref, quoteId)
      const params = new URLSearchParams(window.location.search);
      const orderId = params.get('orderId');
      const txref = params.get('txref') || params.get('ref') || null;
      const quoteId = params.get('quoteId');

      // 3) If no local order, try to fetch by orderId
      if(!order && orderId){
        try{
          const snap = await getDoc(doc(db, "brands", "serac", "orders", orderId));
          if(snap.exists()){ order = snap.data(); order.id = orderId; }
        }catch(e){ console.error('fetch order by id failed', e); }
      }

      // 4) If txref present and still no order, try as doc id then by trackingRef field
      if(!order && txref){
        try{
          // attempt doc id first
          const snap = await getDoc(doc(db, "brands", "serac", "orders", txref));
          if(snap.exists()){
            order = snap.data();
            order.id = snap.id;
          } else {
            // query by trackingRef field
            const q = query(collection(db, "brands", "serac", "orders"), where("trackingRef", "==", txref));
            const snaps = await getDocs(q);
            if(!snaps.empty){
              const s = snaps.docs[0];
              order = s.data(); order.id = s.id;
            }
          }
        }catch(e){ console.error('fetch by txref failed', e); }
      }

      // 5) If still no order, check paidQuoteInfo and/or fetch quote doc
      if(!order && (quoteId || safeParseJSON(localStorage.getItem('paidQuoteInfo'))?.quoteId )){
        const qid = quoteId || safeParseJSON(localStorage.getItem('paidQuoteInfo'))?.quoteId;
        try{
          const qsnap = await getDoc(doc(db, "brands", "serac", "quotes", qid));
          if(qsnap.exists()){
            const qdata = qsnap.data();
            order = {
              id: qid,
              type: 'quote',
              trackingRef: qdata.trackingRef || qdata.orderRef || null,
              name: qdata.name || qdata.customer || qdata.customerName || '',
              email: qdata.email || '',
              phone: qdata.phone || '',
              address: qdata.address || '',
              currency: qdata.currency || 'NGN',
              total: qdata.total || qdata.amount || qdata.subtotal || 0,
              items: qdata.items || []
            };
          }
        }catch(e){ console.error('fetch quote failed', e); }
      }

      // 6) If still nothing â€” display message and remove overlay
      if(!order){
        refBox.textContent = 'No order reference available.';
        note.textContent = '';
        details.innerHTML = '<p>Unable to locate order details. If you just paid, please wait a few moments and refresh.</p>';
        sendEmail.style.display = 'none';
        trackBtn.style.display = 'none';
        fadeRemoveOverlay();
        return;
      }

      // Normalize order for UI usage
      const ref = order.trackingRef || order.tracking || order.orderRef || order.id || 'N/A';
      refBox.textContent = ref;
      note.textContent = 'You can use this reference to track your order.';

      // clicking copies reference
      refBox.onclick = async () => {
        try {
          await navigator.clipboard.writeText(ref);
          showCopyPopup('Copied!');
        } catch(e){ console.error('copy failed', e); }
      };

      // Render details
      const currency = order.currency || order.currencyCode || 'NGN';
      const total = order.total ?? order.amount ?? order.subtotal ?? '-';
      let html = `<h3>Order Details</h3><ul>`;
      html += `<li><strong>Name:</strong> ${escapeHtml(order.name || order.customer || '-')}</li>`;
      html += `<li><strong>Email:</strong> ${escapeHtml(order.email || '-')}</li>`;
      html += `<li><strong>Phone:</strong> ${escapeHtml(order.phone || '-')}</li>`;
      html += `<li><strong>Address:</strong> ${escapeHtml(order.address || '-')}</li>`;
      html += `<li><strong>Currency:</strong> ${escapeHtml(currency)}</li>`;
      html += `<li><strong>Total Paid:</strong> ${escapeHtml(currency)} ${escapeHtml(String(total))}</li>`;
      html += `</ul><h3>Items</h3><ul>`;
      (order.items || []).forEach(i=>{
        const name = i.name || i.productName || i.title || 'Item';
        const qty = i.quantity || i.qty || i.count || 1;
        html += `<li>${escapeHtml(name)} (x${escapeHtml(String(qty))})</li>`;
      });
      html += `</ul>`;
      details.innerHTML = html;

      // Send email button
      sendEmail.onclick = () => {
        const subject = encodeURIComponent('Your SÃ©rac Order Confirmation');
        const body = encodeURIComponent(`Hello ${order.name || ''},

Thank you for shopping with SÃ©rac.

Order reference: ${ref}
Total: ${currency} ${total}

Track here: ${window.location.origin}/trackorder.html

Regards,
SÃ©rac`);
        window.location.href = `mailto:${order.email || ''}?subject=${subject}&body=${body}`;
      };

      // Track button simply goes to trackorder.html
      trackBtn.href = 'trackorder.html';

      // cleanup saved local copies (if any)
      try{ localStorage.removeItem('lastOrder_serac'); localStorage.removeItem('paidQuoteInfo'); }catch(e){}

      // done -> fade overlay after small delay to make transition premium
      setTimeout(fadeRemoveOverlay, 500);
    }

    // small helper to safely escape text for insertion
    function escapeHtml(s){
      if(s === undefined || s === null) return '';
      return String(s).replace(/[&<>"']/g, ch => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[ch]));
    }

    function fadeRemoveOverlay(){
      if(!overlay) return;
      overlay.style.opacity = '0';
      setTimeout(()=>{ overlay.remove?.() }, 600);
    }

    // Start after DOM ready
    document.addEventListener('DOMContentLoaded', () => {
      // Ensure overlay is visible until finish
      try{ overlay.style.opacity = '1'; } catch(e){}
      displayOrder().catch(err => {
        console.error('displayOrder error', err);
        fadeRemoveOverlay();
      });
    });

    const supportBtn = document.getElementById('floatingSupportBtn');
  supportBtn.addEventListener('click', () => {
    window.location.href = 'mailto:stonecold.serac@gmail.com?subject=Support%20Request';
  });



/* -------------------- HEADER/HERO BEHAVIOR (safe version â€“ works with existing hamburger) -------------------- */
(function headerHeroBehavior(){
  const headerEl = document.querySelector('.site-header');
  const heroEl =
    document.querySelector('.hero') ||
    document.getElementById('heroSection') ||
    document.querySelector('.hero-about');
  const hamburger = document.getElementById('hamburger');
  if(!headerEl || !heroEl) return;

  let lastY = window.scrollY || 0;
  let hidden = false;
  let heroHeight = Math.round(heroEl.getBoundingClientRect().height);
  let hoverShown = false;

  function isMenuOpen(){
    return hamburger && hamburger.classList.contains('open');
  }

  function handleScroll(){
    const y = window.scrollY || 0;
    const menuOpen = isMenuOpen();

    // turn header dark after hero
    if(y > Math.max(50, heroHeight - 80))
      headerEl.classList.add('scrolled');
    else
      headerEl.classList.remove('scrolled');

    // if hamburger menu open, force header visible
    if(menuOpen){
      headerEl.style.top = '0';
      headerEl.style.opacity = '1';
      headerEl.style.pointerEvents = 'auto';
      return;
    }

    if(y > heroHeight - 80){
      if(y > lastY && !hidden){
        headerEl.style.top = '-90px';
        headerEl.style.opacity = '0';
        headerEl.style.pointerEvents = 'none';
        hidden = true;
      } else if(y < lastY && hidden){
        headerEl.style.top = '0';
        headerEl.style.opacity = '1';
        headerEl.style.pointerEvents = 'auto';
        headerEl.classList.add('scrolled');
        hidden = false;
      }
    } else {
      headerEl.style.top = '0';
      headerEl.style.opacity = '1';
      headerEl.style.pointerEvents = 'auto';
      headerEl.classList.remove('scrolled');
      hidden = false;
    }

    lastY = y;
  }

  // hover reveal (disabled when menu open)
  document.addEventListener('mousemove', (e) => {
    if(isMenuOpen()) return;

    if(e.clientY < 100){
      if(hidden){
        headerEl.style.top = '0';
        headerEl.style.opacity = '1';
        headerEl.style.pointerEvents = 'auto';
        headerEl.classList.add('scrolled');
        hidden = false;
        hoverShown = true;
      }
    } else if(hoverShown){
      setTimeout(()=>{
        if(window.scrollY > heroHeight - 80 && !isMenuOpen()){
          headerEl.style.top = '-90px';
          headerEl.style.opacity = '0';
          headerEl.style.pointerEvents = 'none';
          hidden = true;
        }
        hoverShown = false;
      }, 220);
    }
  });

  // when hamburger opens/closes, re-evaluate visibility
  if(hamburger){
    hamburger.addEventListener('click', () => {
      setTimeout(handleScroll, 200); // slight delay ensures proper detection
    });
  }

  window.addEventListener('resize', () => {
    heroHeight = Math.round(heroEl.getBoundingClientRect().height);
    handleScroll();
  }, { passive: true });

  window.addEventListener('scroll', handleScroll, { passive: true });
  window.addEventListener('load', () => {
    heroHeight = Math.round(heroEl.getBoundingClientRect().height);
    handleScroll();
  });
})();


    
(function() {
  const applyHeroPeek = () => {
    const heroes = document.querySelectorAll('.hero');
    heroes.forEach(hero => {
      if (hero.querySelector('.hero-peek')) return;

      const peek = document.createElement('div');
      peek.className = 'hero-peek';

      // Determine hero brightness (basic)
      const bg = window.getComputedStyle(hero).backgroundColor;
      let darkHero = true;
      if (bg.startsWith('rgb')) {
        const rgb = bg.match(/\d+/g).map(Number);
        const brightness = (rgb[0]*299 + rgb[1]*587 + rgb[2]*114) / 1000;
        darkHero = brightness < 128; // simple threshold
      }

      peek.dataset.theme = darkHero ? 'dark' : 'light';
      hero.appendChild(peek);
    });
  };

  window.addEventListener('load', applyHeroPeek);
  window.addEventListener('resize', applyHeroPeek);
})();
</script>
  
</body>
</html>
