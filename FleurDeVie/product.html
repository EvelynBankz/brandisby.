<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fleur De Vie - Product</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* RESET & BASE */
 * { margin:0; padding:0; box-sizing:border-box; }
 body { font-family: "Montserrat", sans-serif; background: #F5E6CC; color:#112e1f; line-height:1.6; }
 a { text-decoration:none; color:inherit; }
 
 /* HEADER (Luxury Translucent Version) */
 .site-header {
   background: rgba(17,46,31,0.9); /* deep brand green, slightly see-through */
   backdrop-filter: blur(2px);
   -webkit-backdrop-filter: blur(5px);
   color: #F5E6CC;
   display:flex;
   justify-content:space-between;
   align-items:center;
   padding:10px 24px;
   position:fixed;
   top:0; left:0; right:0;
   z-index:1000;
   height:68px;
   transition: background 0.3s ease, top 0.4s ease, opacity 0.4s ease;
 }
 
 .site-header.scrolled {
   background: #112e1f; /* solid brand color after scroll */
 }
 
 .site-header.hidden {
   opacity: 0;
   top: -80px;
   pointer-events: none;
 }
 
 .site-header:hover {
   background: rgba(17,46,31,0.9);
 }
 
 .header-left { display:flex; align-items:center; gap:10px; }
 .brand-logo { height:70px; transition:height 0.3s ease; }
 .brand-title { font-family:"Playfair Display", serif; font-size:22px; font-weight:700; }
 
 .header-right { display:flex; gap:20px; align-items:center; }
 
 .header-right a {
   font-weight: 500;
   color: inherit;
   position: relative;
   transition: color 0.3s ease, transform 0.3s ease;
 }
 
 .header-right a:hover {
   color: #c9e4ff;
   transform: translateY(-2px);
 }
 .cart-count { background:#FFD6BA; color:#112e1f; font-size:12px; font-weight:600; border-radius:50%; padding:2px 6px; margin-left:4px; }
 
 .hamburger { display:none; background:none; border:none; cursor:pointer; width:30px; height:24px; position:relative; }
 .hamburger span { display:block; width:100%; height:3px; background:#F5E6CC; border-radius:2px; position:absolute; left:0; transition:0.3s; }
 .hamburger span:nth-child(1){ top:0; }
 .hamburger span:nth-child(2){ top:10px; }
 .hamburger span:nth-child(3){ top:20px; }
 .hamburger.open span:nth-child(1){ transform:rotate(45deg); top:10px; }
 .hamburger.open span:nth-child(2){ opacity:0; }
 .hamburger.open span:nth-child(3){ transform:rotate(-45deg); top:10px; }

   
/* PRODUCT */
 main { padding:120px 20px 40px; max-width:1000px; margin:auto; display:flex; gap:40px; flex-wrap:wrap; justify-content:center; }
.product-image { flex:1 1 300px; max-width:400px; display:flex; flex-direction:column; gap:10px; }
.product-image img { width:100%; object-fit:contain; border-radius:12px; background:#fff; cursor:pointer; }
.thumbnail-container { display:flex; gap:8px; overflow-x:auto; scroll-behavior:smooth; -webkit-overflow-scrolling: touch; padding-bottom:6px; }
.thumbnail-container img { width:60px; height:60px; object-fit:contain; border:1px solid #ccc; border-radius:6px; cursor:pointer; transition:0.2s; flex-shrink:0; }
.thumbnail-container img:hover, .thumbnail-container img.selected { border-color:#112e1f; }

.product-details { flex:1 1 300px; max-width:500px; display:flex; flex-direction:column; gap:12px; }
.product-details h1 { font-family:"Playfair Display", serif; font-size:2rem; }
.product-details .description { font-size:1rem; color:#112e1f; }
.product-details .price { font-weight:600; font-size:1.2rem; margin-bottom:12px; }
.options-container { display:flex; gap:10px; flex-wrap:wrap; margin-bottom:12px; }
.options-container button { padding:8px 12px; border-radius:6px; border:1px solid #112e1f; cursor:pointer; background:#fff; transition:0.2s; }
.options-container button:hover, .options-container button.selected { background:#112e1f; color:#FFD6BA; }

.quantity-controls { display:flex; align-items:center; gap:10px; margin-bottom:16px; }
.quantity-controls button { background:#112e1f; color:#F5E6CC; border:none; border-radius:6px; padding:8px 12px; cursor:pointer; transition:0.3s; }
.quantity-controls button:hover { background:#0a1d14; }
.quantity-badge { font-weight:600; min-width:24px; text-align:center; display:inline-block; }

.add-cart { background:#112e1f; color:#F5E6CC; border:none; border-radius:6px; padding:12px; cursor:pointer; font-size:1rem; transition:0.3s; }
.add-cart:hover { background:#0a1d14; }

.customize-btn { background:#FFD6BA; color:#112e1f; border:none; border-radius:6px; padding:12px; cursor:pointer; font-size:1rem; font-weight:600; text-align:center; margin-top:10px; transition:0.3s; }
.customize-btn:hover { background:#ffc999; }

/* Buttons row for desktop + sticky mobile container */
.buttons-row { display:flex; gap:10px; margin-top:16px; align-items:center; }
.back-btn { background:#112e1f; color:#F5E6CC; border:none; border-radius:6px; padding:12px; cursor:pointer; font-size:1rem; font-weight:500; text-align:center; }
.back-btn:hover { background:#0a1d14; }

/* mobile actions (hidden by default; shown fixed on small screens) */
.mobile-actions { display:none; }

/* FOOTER */
footer { text-align:center; padding:20px; background:transparent; color:#112e1f; margin-top:60px; }

/* RESPONSIVE */
@media(max-width:800px){ main { flex-direction:column; align-items:center; } .product-image, .product-details { max-width:90%; } }
@media (max-width:900px) {
  .header-right {
    position: absolute;
    top: 68px;
    right: 0;
    background: rgba(17,46,31,0.95);
    flex-direction: column;
    width: 200px;
    padding: 20px;
    display: none;
    border-radius: 0 0 0 10px;
    z-index: 1100;
  }

  .header-right.open {
    display: flex !important;
    flex-direction: column;
    gap: 12px;
  }

  .hamburger {
    display: block;
  }

  /* --- Mobile floating actions (Back button) --- */
  .mobile-actions {
    display: flex;
    position: fixed;
    bottom: 18px;
    left: 50%;
    transform: translateX(-50%);
    width: 92%;
    max-width: 540px;
    z-index: 999;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.3s ease, transform 0.3s ease;
  }

  .mobile-actions.visible {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }

  .mobile-actions .back-btn {
    background: #112e1f;
    color: #F5E6CC;
    border: none;
    border-radius: 8px;
    padding: 10px 18px;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  .mobile-actions .back-btn:hover {
    background: #0a1d14;
  }
}


/* ---------------- Floating Support Button + Tooltip ---------------- */
  #floatingSupportBtn {
    position: fixed;
    right: 22px;
    bottom: 22px;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    border: none;
    background: #112e1f;
    color: #fff;
    z-index: 10002;
    box-shadow: 0 8px 30px rgba(212,245,105,1);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px; /* enlarged icon */
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  #floatingSupportBtn:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 36px rgba(212,245,105,0.8);
    animation: glowPulse 1.5s infinite ease-in-out;
  }
  #floatingSupportBtn::after {
    content: "Support";
    position: absolute;
    bottom: 70px;
    left: 50%;
    transform: translateX(-50%) translateY(0);
    background: #112e1f;
    color: #FFD6BA;
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 500;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.4s ease, transform 0.4s ease;
  }
  #floatingSupportBtn:hover::after {
    opacity: 1;
    transform: translateX(-50%) translateY(-6px);
  }
  @keyframes glowPulse {
    0%,100%{ box-shadow:0 8px 30px rgba(212,245,105,1);}
    50%{ box-shadow:0 12px 36px rgba(212,245,105,0.6);}
  }


</style>
</head>
<body>

<header class="site-header">
  <div class="header-left">
    <img src="asset/logo.png" alt="Fleur De Vie Logo" class="brand-logo">
    <div class="brand-title">Fleur De Vie</div>
  </div>
 <!-- Hamburger -->
  <button class="hamburger" id="hamburger-btn">
    <span></span><span></span><span></span>
  </button>
  <nav class="header-right" id="nav-menu">
    <a href="index.html">Home</a>
    <a href="shop.html">Shop</a>
    <a href="about.html">About</a>
    <a href="cart.html">Cart <span class="cart-count" id="cartCount">0</span></a>
    <a href="customization.html">Customize</a>
    <a href="contact.html">Contact</a>
    <a href="trackorder.html">Track</a>
  </nav>
</header>

<main id="productContainer">
  <div class="product-image">
    <img id="productImg" src="" alt="Product Image">
    <div class="thumbnail-container" id="thumbnailContainer"></div>
  </div>
  <div class="product-details">
    <h1 id="productName">Product Name</h1>
    <div class="description" id="productDescription">Product description will appear here.</div>
    <div class="price" id="productPrice">₦0.00</div>

    <div class="options-container" id="colorOptions"></div>
    <div class="options-container" id="sizeOptions"></div>

    <div class="quantity-controls">
      <button id="minus">-</button>
      <span class="quantity-badge" id="quantityBadge">0</span>
      <button id="plus">+</button>
    </div>

    <button class="add-cart" id="addCartBtn">Add to Cart</button>

    <a href="customization.html" id="customizeBtn" class="customize-btn" style="display:none;">Customize this Product</a>

    <div class="buttons-row" style="margin-bottom:12px;">
      <a href="shop.html" class="back-btn" id="backBtnDesktop">← Back to Shop</a>
    </div>

    <div class="mobile-actions" id="mobileActions" aria-hidden="true">
      <a href="shop.html" class="back-btn">← Back to Shop</a>
    </div>
  </div>
</main>
   
<!-- Floating support button -->
<button id="floatingSupportBtn" aria-label="Support">
  <i class="fas fa-headset"></i>
</button>
   
<footer>
  <p>© <span id="year"></span> Fleur De Vie</p>
</footer>


<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCuiZXHFYl1fVKnGwojavRvbekSBpkipJg",
  authDomain: "brandisby.firebaseapp.com",
  projectId: "brandisby",
  storageBucket: "brandisby.firebasestorage.app",
  messagingSenderId: "87213267039",
  appId: "1:87213267039:web:339e9fd49e3ad31f7423ea"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const productImg = document.getElementById('productImg');
const productName = document.getElementById('productName');
const productDescription = document.getElementById('productDescription');
const productPrice = document.getElementById('productPrice');
const quantityBadge = document.getElementById('quantityBadge');
const addCartBtn = document.getElementById('addCartBtn');
const minusBtn = document.getElementById('minus');
const plusBtn = document.getElementById('plus');
const cartCountElem = document.getElementById('cartCount');
const customizeBtn = document.getElementById('customizeBtn');
const thumbnailContainer = document.getElementById('thumbnailContainer');
const colorOptions = document.getElementById('colorOptions');
const sizeOptions = document.getElementById('sizeOptions');

let currentProductData = null;

/* CART helpers */
function getCart(){ return JSON.parse(localStorage.getItem('cart')) || []; }
function setCart(cart){ localStorage.setItem('cart', JSON.stringify(cart)); updateCartCount(); }
function updateCartCount(){
  const cart = getCart();
  cartCountElem.textContent = cart.reduce((sum,item)=>sum+Number(item.quantity||0),0);
}

/* Sum all variants for this product */
function updateQuantityUI(productId){
  const cart = getCart();
  const totalQuantity = cart.filter(i=>i.id===productId).reduce((sum,i)=>sum+Number(i.quantity||0),0);
  quantityBadge.textContent = totalQuantity;
  addCartBtn.style.display = totalQuantity > 0 ? 'none' : 'block';
}

/* add and remove */
function addToCart(product){
  let cart = getCart();
  const index = cart.findIndex(i=>i.id===product.id && (i.color||'')=== (product.color||'') && (i.size||'') === (product.size||''));
  if(index > -1){
    cart[index].quantity = Number(cart[index].quantity || 0) + 1;
  } else {
    cart.push({...product, quantity:1});
  }
  setCart(cart);
  updateQuantityUI(product.id);
}
function removeFromCart(productId){
  let cart = getCart();
  const sel = getSelectedOptions();
  const index = cart.findIndex(i=>i.id===productId && (i.color||'')=== (sel.color||'') && (i.size||'') === (sel.size||''));
  if(index > -1){
    cart[index].quantity = Number(cart[index].quantity || 0) - 1;
    if(cart[index].quantity <= 0){ cart.splice(index,1); }
    setCart(cart);
  }
  updateQuantityUI(productId);
}

/* URL params */
const urlParams = new URLSearchParams(window.location.search);
const productId = urlParams.get('productId');
const urlPrice = parseFloat(urlParams.get('price'));
const urlCurrency = urlParams.get('currency');

/* Load product */
async function loadProduct(){
  if(!productId) return;
  try{
    const docRef = doc(db,"brands","fleurdevie","products",productId);
    const docSnap = await getDoc(docRef);
    if(docSnap.exists()){
      const data = docSnap.data();
      currentProductData = data;

      const images = Array.isArray(data.images) && data.images.length
        ? data.images.filter(Boolean)
        : (data.imageUrl ? [data.imageUrl] : []);
      productImg.src = images[0] || '';
      thumbnailContainer.innerHTML = '';
      images.forEach((imgUrl, idx)=>{
        if(!imgUrl) return;
        const thumb = document.createElement('img');
        thumb.src = imgUrl;
        if(idx===0) thumb.classList.add('selected');
        thumb.addEventListener('click', ()=>{
          productImg.src = imgUrl;
          thumbnailContainer.querySelectorAll('img').forEach(i=>i.classList.remove('selected'));
          thumb.classList.add('selected');
        });
        thumbnailContainer.appendChild(thumb);
      });

      productName.textContent = data.name || '';
      productDescription.textContent = data.description || '';

      const displayPrice = !isNaN(urlPrice) ? urlPrice : (data.price || 0);
      const displayCurrency = urlCurrency || data.currency || 'NGN';
      const localeMap = { NGN:'en-NG', USD:'en-US', EUR:'de-DE', GBP:'en-GB' };
      const minFrac = displayCurrency === 'NGN' ? 0 : 2;
      try {
        productPrice.textContent = new Intl.NumberFormat(localeMap[displayCurrency] || 'en-US', { style:'currency', currency: displayCurrency, minimumFractionDigits: minFrac }).format(displayPrice);
      } catch(e) {
        productPrice.textContent = `${displayCurrency} ${displayPrice}`;
      }
      currentProductData.price = displayPrice;
      currentProductData.currency = displayCurrency;

      if(data.customizationAvailable){
        customizeBtn.style.display='block';
        customizeBtn.href=`customization.html?productId=${productId}`;
      } else { customizeBtn.style.display='none'; }

      colorOptions.innerHTML='';
      if(Array.isArray(data.colors) && data.colors.length){
        data.colors.forEach(c=>{
          const btn = document.createElement('button'); btn.textContent=c;
          btn.addEventListener('click',()=>{
            Array.from(colorOptions.children).forEach(b=>b.classList.remove('selected'));
            btn.classList.add('selected');
            updateQuantityUI(productId);
          });
          colorOptions.appendChild(btn);
        });
      }

      sizeOptions.innerHTML='';
      if(Array.isArray(data.sizes) && data.sizes.length){
        data.sizes.forEach(s=>{
          const btn = document.createElement('button'); btn.textContent=s;
          btn.addEventListener('click',()=>{
            Array.from(sizeOptions.children).forEach(b=>b.classList.remove('selected'));
            btn.classList.add('selected');
            updateQuantityUI(productId);
          });
          sizeOptions.appendChild(btn);
        });
      }

      updateQuantityUI(productId);

    } else {
      document.getElementById('productContainer').innerHTML='<p style="text-align:center; color:red;">Product not found.</p>';
    }
  } catch(err){
    console.error(err);
    document.getElementById('productContainer').innerHTML='<p style="text-align:center; color:red;">Failed to load product.</p>';
  }
}

/* selection */
function getSelectedOptions(){
  return {
    color: colorOptions.querySelector('.selected')?.textContent || '',
    size: sizeOptions.querySelector('.selected')?.textContent || ''
  };
}

/* Cart button handlers */
addCartBtn.addEventListener('click', ()=> {
  if(!currentProductData) return;
  const sel = getSelectedOptions();
  addToCart({ id: productId, name: currentProductData.name, price: currentProductData.price, currency: currentProductData.currency, imageUrl: productImg.src, color: sel.color, size: sel.size });
});
plusBtn.addEventListener('click', ()=> {
  if(!currentProductData) return;
  const sel = getSelectedOptions();
  addToCart({ id: productId, name: currentProductData.name, price: currentProductData.price, currency: currentProductData.currency, imageUrl: productImg.src, color: sel.color, size: sel.size });
});
minusBtn.addEventListener('click', ()=> { removeFromCart(productId); });

 
   
// hamburger
const hamburgerBtn = document.getElementById('hamburger-btn');
const navMenu = document.getElementById('nav-menu');
if(hamburgerBtn) hamburgerBtn.addEventListener('click', ()=>{ hamburgerBtn.classList.toggle('open'); if(navMenu) navMenu.classList.toggle('open'); });


/* Thumbnails swipe */
let isDown=false, startX, scrollLeft;
thumbnailContainer.addEventListener('mousedown', e=>{ isDown=true; startX=e.pageX - thumbnailContainer.offsetLeft; scrollLeft=thumbnailContainer.scrollLeft; });
thumbnailContainer.addEventListener('mouseleave', ()=>{ isDown=false; });
thumbnailContainer.addEventListener('mouseup', ()=>{ isDown=false; });
thumbnailContainer.addEventListener('mousemove', e=>{ if(!isDown)return; e.preventDefault(); const x=e.pageX - thumbnailContainer.offsetLeft; const walk=(x-startX)*2; thumbnailContainer.scrollLeft=scrollLeft-walk; });

window.addEventListener('storage', ()=>{ updateCartCount(); updateQuantityUI(productId); });
updateCartCount();
loadProduct();

// ----------------- Footer Year -----------------
document.getElementById('year').textContent = new Date().getFullYear();
  

/*------New header Settings-----*/
/* ---- Header Hide/Show (No Hero Version) ---- */
const header = document.querySelector('.site-header');
if (header) {
  let lastScrollY = window.scrollY;
  let isHidden = false;

  function handleScroll() {
    const nowY = window.scrollY;

    if (nowY > 80) { // start after a little scroll
      if (nowY > lastScrollY && !isHidden) {
        header.classList.add('hidden');
        isHidden = true;
      } else if (nowY < lastScrollY && isHidden) {
        header.classList.remove('hidden');
        header.classList.add('scrolled');
        isHidden = false;
      }
    } else {
      header.classList.remove('hidden', 'scrolled');
      isHidden = false;
    }

    lastScrollY = nowY;
  }

  window.addEventListener('scroll', handleScroll, { passive: true });

  // Show header when hovering near top
  document.addEventListener('mousemove', e => {
    if (e.clientY < 100 && isHidden) {
      header.classList.remove('hidden');
      header.classList.add('scrolled');
      isHidden = false;
    }
  });
}

  
// ----------------- Support Button ----------------- 
// Floating support
const supportBtn = document.getElementById('floatingSupportBtn');
supportBtn?.addEventListener('click', () => {
  window.location.href = 'mailto:yourstruly.fleurdevie@gmail.com?subject=Support%20Request';
});

</script>

 <script>
document.addEventListener("DOMContentLoaded", () => {
  const backBtn = document.querySelector(".mobile-actions");
  if (!backBtn) return;

  // Function to check scroll position
  function handleScroll() {
    const scrollY = window.scrollY + window.innerHeight;
    const docHeight = document.documentElement.scrollHeight;

    // Fade in when near bottom (last 20% of page)
    if (scrollY >= docHeight * 0.8) {
      backBtn.style.opacity = "1";
    } else {
      backBtn.style.opacity = "0";
    }
  }

  window.addEventListener("scroll", handleScroll);
});
</script>

</body>
</html>
